<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aslan Group Portal - Giri≈ü</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="../assets/css/login.css">
    <link rel="stylesheet" href="../assets/css/layout-fix.css">
    <style>
        /* Login page specific styles */
        .shake {
            animation: shake 0.5s;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .btn-loading {
            position: relative;
        }
        
        .form-floating.focused label {
            color: #0d6efd;
        }
    </style>
</head>
<body class="bg-light">
    <!-- Alert Container -->
    <div id="alertContainer" class="container mt-3" style="position: fixed; top: 0; left: 50%; transform: translateX(-50%); z-index: 1050; width: 90%; max-width: 500px;"></div>

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6 col-lg-4">
                <div class="card shadow-lg border-0 rounded-lg mt-5">
                    <div class="card-header">
                        <h3 class="text-center font-weight-light my-4">
                            <img src="../assets/images/logo.png" alt="Vervo" class="mb-3" style="height: 60px;">
                            <br>Aslan Group Portal
                        </h3>
                    </div>
                    <div class="card-body">
                        <form id="loginForm">
                            <div class="form-floating mb-3">
                                <input class="form-control" id="username" name="username" type="text" placeholder="Kullanƒ±cƒ± Adƒ±" required>
                                <label for="username">Kullanƒ±cƒ± Adƒ±</label>
                            </div>
                            <div class="form-floating mb-3">
                                <input class="form-control" id="password" name="password" type="password" placeholder="≈ûifre" required>
                                <label for="password">≈ûifre</label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" id="rememberMe" type="checkbox" value="">
                                <label class="form-check-label" for="rememberMe">Beni Hatƒ±rla</label>
                            </div>
                            <div class="d-flex align-items-center justify-content-between mt-4 mb-0">
                                <button class="btn btn-primary w-100" type="submit" id="loginBtn">
                                    <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                                    <span class="btn-text">Giri≈ü Yap</span>
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="card-footer text-center py-3">
                        <div class="small">
                            <a href="../index.html" class="text-decoration-none">‚Üê Ana Sayfaya D√∂n</a>
                        </div>
                        <div class="small text-muted mt-2">
                            Portal kullanƒ±cƒ± bilgileriniz ile giri≈ü yapƒ±n
                        </div>
                        <!-- Test butonu -->
                        <div class="mt-2">
                            <button type="button" class="btn btn-sm btn-outline-primary" onclick="testRedirect()">
                                üöÄ Dashboard Test
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-success" onclick="forceRedirect()">
                                ‚ö° Force Redirect
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-warning" onclick="resetPage()">
                                üîÑ Reset
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="../assets/js/utils.js"></script>
    <script src="../assets/js/auth.js"></script>
    <script src="../assets/js/login.js"></script>
    
    <script>
        // Login sayfasƒ± i√ßin auth kontrol√º
        $(document).ready(function() {
            console.log('Login page loaded, checking if already authenticated...');
            
            // Eƒüer kullanƒ±cƒ± zaten giri≈ü yapmƒ±≈üsa dashboard'a y√∂nlendir
            if (authService && authService.isAuthenticated()) {
                console.log('User already authenticated, redirecting to dashboard...');
                window.location.href = './dashboard.html';
                return;
            }
            
            console.log('User not authenticated, login page ready');
        });
        
        // Test redirect function
        function testRedirect() {
            console.log('Testing manual redirect...');
            console.log('Current path:', window.location.pathname);
            
            const dashboardPath = './dashboard.html';
            console.log('Target path:', dashboardPath);
            
            alert(`Test redirect to: ${dashboardPath}\nCheck console for details.`);
            
            setTimeout(() => {
                window.location.href = dashboardPath;
            }, 1000);
        }
        
        // Force redirect function
        function forceRedirect() {
            console.log('FORCE REDIRECT - bypassing all checks...');
            const dashboardPath = './dashboard.html';
            console.log('Force redirecting to:', dashboardPath);
            
            // Try all methods immediately
            try {
                window.location.href = dashboardPath;
            } catch (e) {
                console.log('href failed, trying assign...');
                window.location.assign(dashboardPath);
            }
            
            setTimeout(() => {
                window.location.replace(dashboardPath);
            }, 100);
        }
        
        // Sƒ±fƒ±rlama fonksiyonu
        function resetPage() {
            console.log('Resetting page...');
            localStorage.clear();
            location.reload();
        }
    </script>
</body>
</html>